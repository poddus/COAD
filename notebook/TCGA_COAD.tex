
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{TCGA\_COAD}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \subsection{Notes}\label{notes}

\begin{itemize}
\tightlist
\item
  In order to maintain consistency in naming conventions, files and
  cases are referred to strictly by their UUID.
\item
  The original plan was to use a single \texttt{case\_to\_file}
  dictionary to store all files for a given case, and output all data
  into a common directory. It has remained in place since it most
  naturally represents the data as a file belonging to a case, but its
  use creates more work. May be refactored at a later time.
\end{itemize}

    \subsection{Set Flags}\label{set-flags}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{n}{first\PYZus{}run} \PY{o}{=} \PY{k+kc}{False}
        \PY{n}{verbose} \PY{o}{=} \PY{k+kc}{True}
        
        \PY{n}{verboseprint} \PY{o}{=} \PY{n+nb}{print} \PY{k}{if} \PY{n}{verbose} \PY{k}{else} \PY{k}{lambda} \PY{o}{*}\PY{n}{a}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{k}\PY{p}{:} \PY{k+kc}{None}
\end{Verbatim}


    \subsection{Dependencies}\label{dependencies}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{k+kn}{import} \PY{n+nn}{os}
        \PY{k+kn}{import} \PY{n+nn}{glob}
        \PY{k+kn}{import} \PY{n+nn}{requests}
        \PY{k+kn}{import} \PY{n+nn}{csv}
        \PY{k+kn}{import} \PY{n+nn}{shutil}
        \PY{k+kn}{from} \PY{n+nn}{collections} \PY{k}{import} \PY{n}{defaultdict}
        \PY{k}{try}\PY{p}{:}
            \PY{k+kn}{import} \PY{n+nn}{simplejson} \PY{k}{as} \PY{n+nn}{json}
        \PY{k}{except} \PY{n+ne}{ImportError}\PY{p}{:}
            \PY{k+kn}{import} \PY{n+nn}{json}
        \PY{k+kn}{import} \PY{n+nn}{gzip}
        
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{xml}\PY{n+nn}{.}\PY{n+nn}{etree}\PY{n+nn}{.}\PY{n+nn}{ElementTree} \PY{k}{as} \PY{n+nn}{ET}
        
        \PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k}{import} \PY{n}{interp}
        \PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{import} \PY{n}{get\PYZus{}cmap}
        
        \PY{k+kn}{from} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{offline} \PY{k}{import} \PY{n}{download\PYZus{}plotlyjs}
        \PY{k+kn}{from} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{offline} \PY{k}{import} \PY{n}{init\PYZus{}notebook\PYZus{}mode}
        \PY{k+kn}{from} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{offline} \PY{k}{import} \PY{n}{iplot}
        \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{graph\PYZus{}objs} \PY{k}{as} \PY{n+nn}{go}
        \PY{n}{init\PYZus{}notebook\PYZus{}mode}\PY{p}{(}\PY{p}{)}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{manifold} \PY{k}{import} \PY{n}{TSNE}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegressionCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{StratifiedKFold}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{classification\PYZus{}report}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{precision\PYZus{}recall\PYZus{}curve}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{auc}
        
        \PY{n}{input\PYZus{}dir} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{getcwd}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{in}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{output\PYZus{}dir} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{getcwd}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{out}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} initialize input directory}
        \PY{n}{in\PYZus{}clin\PYZus{}manifest} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}
            \PY{n}{input\PYZus{}dir}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clinical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clinical\PYZus{}manifest.tsv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{in\PYZus{}clin\PYZus{}data} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}
            \PY{n}{input\PYZus{}dir}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clinical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{in\PYZus{}maf\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{input\PYZus{}dir}\PY{p}{,}
          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{maf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TCGA.COAD.mutect.853e5584\PYZhy{}b8c3\PYZhy{}4836\PYZhy{}9bda\PYZhy{}6e7e84a64d97.DR\PYZhy{}7.0.somatic.maf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{varsome\PYZus{}api\PYZus{}key\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{input\PYZus{}dir}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{varsome\PYZus{}api\PYZus{}key}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} initialize output directory}
        \PY{n}{out\PYZus{}clin\PYZus{}data} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{output\PYZus{}dir}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clinical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{out\PYZus{}clin\PYZus{}meta} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{output\PYZus{}dir}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clinical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{meta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{mut\PYZus{}df\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{output\PYZus{}dir}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mut\PYZus{}df.gz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{trans\PYZus{}df\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{output\PYZus{}dir}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trans\PYZus{}df.gz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{k}{if} \PY{n}{first\PYZus{}run}\PY{p}{:}
            \PY{k}{for} \PY{n}{path} \PY{o+ow}{in} \PY{p}{[}\PY{n}{out\PYZus{}clin\PYZus{}data}\PY{p}{,} \PY{n}{out\PYZus{}clin\PYZus{}meta}\PY{p}{]}\PY{p}{:}
                \PY{n}{os}\PY{o}{.}\PY{n}{mkdirs}\PY{p}{(}\PY{n}{path}\PY{p}{)}
                
        \PY{k}{class} \PY{n+nc}{tcgaFileQuery}\PY{p}{:}
            \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{file\PYZus{}id}\PY{p}{)}\PY{p}{:}
                \PY{n}{\PYZus{}cases\PYZus{}endpt} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{https://gdc\PYZhy{}api.nci.nih.gov/files/ids}\PY{l+s+s1}{\PYZsq{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}payload} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{query}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{file\PYZus{}id}\PY{p}{\PYZcb{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}response} \PY{o}{=} \PY{n}{requests}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{\PYZus{}cases\PYZus{}endpt}\PY{p}{,} \PY{n}{params}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}payload}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}response}\PY{o}{.}\PY{n}{json}\PY{p}{(}\PY{p}{)}
        
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{case\PYZus{}id} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cases}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data\PYZus{}type} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{k}{def} \PY{n+nf}{dump\PYZus{}json}\PY{p}{(}\PY{n}{json\PYZus{}data}\PY{p}{,} \PY{n}{path}\PY{p}{)}\PY{p}{:}
            \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{jsonFile}\PY{p}{:}
                \PY{n}{json}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{json\PYZus{}data}\PY{p}{,} \PY{n}{jsonFile}\PY{p}{,} \PY{n}{separators}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{indent}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
                
        \PY{k}{def} \PY{n+nf}{fetch\PYZus{}metadata}\PY{p}{(}\PY{n}{manifest}\PY{p}{,} \PY{n}{output\PYZus{}location}\PY{p}{)}\PY{p}{:}
            \PY{n}{file\PYZus{}to\PYZus{}case} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
            \PY{n}{UUID\PYZus{}to\PYZus{}filename} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
        
            \PY{c+c1}{\PYZsh{} metadata from server to file\PYZus{}to\PYZus{}case}
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loading }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{manifest} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{manifest}\PY{p}{)} \PY{k}{as} \PY{n}{tsvFile}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} get lenth of manifest file}
                \PY{k}{for} \PY{n}{line\PYZus{}count}\PY{p}{,} \PY{n}{value} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tsvFile}\PY{p}{)}\PY{p}{:}
                    \PY{k}{pass}
                \PY{n}{tsvFile}\PY{o}{.}\PY{n}{seek}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}  \PY{c+c1}{\PYZsh{} return to top of file}
                \PY{n}{tsvData} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{reader}\PY{p}{(}\PY{n}{tsvFile}\PY{p}{,} \PY{n}{delimiter}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
                \PY{n+nb}{next}\PY{p}{(}\PY{n}{tsvData}\PY{p}{,} \PY{k+kc}{None}\PY{p}{)}  \PY{c+c1}{\PYZsh{} skip header row of manifest file}
                \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{tsvData}\PY{p}{:}
                    \PY{n}{file\PYZus{}id} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                    \PY{n}{UUID\PYZus{}to\PYZus{}filename}\PY{p}{[}\PY{n}{file\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                    
                    \PY{n}{verboseprint}\PY{p}{(}
                        \PY{n+nb}{str}\PY{p}{(}\PY{n}{line\PYZus{}count}\PY{p}{)}
                        \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{fetching metadata for }\PY{l+s+s1}{\PYZsq{}}
                        \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{file\PYZus{}id}\PY{p}{)}
                        \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
                        \PY{p}{)}
        
                    \PY{n}{json\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}
                        \PY{n}{output\PYZus{}location}\PY{p}{,}
                        \PY{n+nb}{str}\PY{p}{(}\PY{n}{file\PYZus{}id}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}meta.json}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                    
                    \PY{k}{if} \PY{n}{first\PYZus{}run}\PY{p}{:}
                        \PY{n}{queryResult} \PY{o}{=} \PY{n}{tcgaFileQuery}\PY{p}{(}\PY{n}{file\PYZus{}id}\PY{p}{)}
                        \PY{n}{dump\PYZus{}json}\PY{p}{(}\PY{n}{queryResult}\PY{o}{.}\PY{n}{data}\PY{p}{,} \PY{n}{json\PYZus{}file}\PY{p}{)}
        
                       \PY{c+c1}{\PYZsh{} store important metadata in databse}
                        \PY{n}{file\PYZus{}to\PYZus{}case}\PY{p}{[}\PY{n}{file\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{queryResult}\PY{o}{.}\PY{n}{case\PYZus{}id}\PY{p}{,}
                                                 \PY{n}{queryResult}\PY{o}{.}\PY{n}{data\PYZus{}type}\PY{p}{)}
        
                    \PY{k}{else}\PY{p}{:}
                        \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{json\PYZus{}file}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{jsonFile}\PY{p}{:}
                            \PY{n}{reader} \PY{o}{=} \PY{n}{jsonFile}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}
                            \PY{n}{jsonData} \PY{o}{=} \PY{n}{json}\PY{o}{.}\PY{n}{loads}\PY{p}{(}\PY{n}{reader}\PY{p}{)}
        
                        \PY{n}{json\PYZus{}case\PYZus{}id} \PY{o}{=} \PY{n}{jsonData}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cases}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                        \PY{n}{json\PYZus{}data\PYZus{}type} \PY{o}{=} \PY{n}{jsonData}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
                        \PY{c+c1}{\PYZsh{} store important metadata in databse}
                        \PY{n}{file\PYZus{}to\PYZus{}case}\PY{p}{[}\PY{n}{file\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{n}{json\PYZus{}case\PYZus{}id}\PY{p}{,} \PY{n}{json\PYZus{}data\PYZus{}type}
        
                    \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{done}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                    \PY{n}{line\PYZus{}count} \PY{o}{\PYZhy{}}\PY{o}{=} \PY{l+m+mi}{1}
        
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all metadata retrieved successfully}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flipping association...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} flip association, since one case potentially}
            \PY{c+c1}{\PYZsh{} contains multiple files}
            \PY{n}{case\PYZus{}to\PYZus{}file} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
            \PY{k}{for} \PY{n}{file\PYZus{}id} \PY{o+ow}{in} \PY{n}{file\PYZus{}to\PYZus{}case}\PY{p}{:}
                \PY{n}{case\PYZus{}id} \PY{o}{=} \PY{n}{file\PYZus{}to\PYZus{}case}\PY{p}{[}\PY{n}{file\PYZus{}id}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                \PY{n}{file\PYZus{}type} \PY{o}{=} \PY{n}{file\PYZus{}to\PYZus{}case}\PY{p}{[}\PY{n}{file\PYZus{}id}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                \PY{n}{case\PYZus{}to\PYZus{}file}\PY{p}{[}\PY{n}{case\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{n}{file\PYZus{}id}\PY{p}{,} \PY{n}{file\PYZus{}type}
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{done}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{k}{return} \PY{n}{case\PYZus{}to\PYZus{}file}\PY{p}{,} \PY{n}{UUID\PYZus{}to\PYZus{}filename}
        
        \PY{k}{def} \PY{n+nf}{remove\PYZus{}annotated}\PY{p}{(}\PY{n}{input\PYZus{}data}\PY{p}{,} \PY{n}{case\PYZus{}to\PYZus{}file}\PY{p}{,} \PY{n}{UUID\PYZus{}to\PYZus{}filename}\PY{p}{)}\PY{p}{:}
            
            \PY{c+c1}{\PYZsh{} by using a defaultdict, even if multiple files}
            \PY{c+c1}{\PYZsh{} of a case are annotated, no duplicate entries are}
            \PY{c+c1}{\PYZsh{} created (as with a list) and no key errors result}
            \PY{n}{is\PYZus{}annotated} \PY{o}{=} \PY{n}{defaultdict}\PY{p}{(}\PY{k}{lambda}\PY{p}{:} \PY{k+kc}{False}\PY{p}{)}
        
            \PY{k}{for} \PY{n}{case\PYZus{}id}\PY{p}{,} \PY{n}{f} \PY{o+ow}{in} \PY{n}{case\PYZus{}to\PYZus{}file}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{n}{file\PYZus{}id} \PY{o}{=} \PY{n}{f}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                \PY{n}{path\PYZus{}to\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{input\PYZus{}data}\PY{p}{,}
                                            \PY{n}{file\PYZus{}id}\PY{p}{,}
                                            \PY{n}{UUID\PYZus{}to\PYZus{}filename}\PY{p}{[}\PY{n}{file\PYZus{}id}\PY{p}{]}\PY{p}{)}
                    
        \PY{c+c1}{\PYZsh{}         verboseprint(\PYZsq{}looking at file\PYZsq{}, file\PYZus{}id, \PYZsq{}... \PYZsq{})}
                \PY{k}{if} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{path\PYZus{}to\PYZus{}file}\PY{p}{)}\PY{p}{[}
                    \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{annotations.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                    \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{annotation found for case}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{case\PYZus{}id}\PY{p}{)}
                    \PY{n}{is\PYZus{}annotated}\PY{p}{[}\PY{n}{case\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{k+kc}{True}
        
            \PY{n}{verboseprint}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{is\PYZus{}annotated}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{annotated cases found}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignoring annotated cases}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{k}{for} \PY{n}{case} \PY{o+ow}{in} \PY{n}{is\PYZus{}annotated}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{k}{del} \PY{n}{case\PYZus{}to\PYZus{}file}\PY{p}{[}\PY{n}{case}\PY{p}{]}
            
            \PY{k}{return} \PY{n}{case\PYZus{}to\PYZus{}file}
\end{Verbatim}


    
    
    \subsection{Retrieve from Disk}\label{retrieve-from-disk}

if the workflow has been executed before, the assembled DataFrame can be
extracted from disk. Use the link below to jump to the Data Analysis
section.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}pickle}\PY{p}{(}\PY{n}{mut\PYZus{}df\PYZus{}file}\PY{p}{,} \PY{n}{compression}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gzip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{case\PYZus{}to\PYZus{}trans\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}pickle}\PY{p}{(}\PY{n}{trans\PYZus{}df\PYZus{}file}\PY{p}{,} \PY{n}{compression}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gzip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \textbf{Section \ref{exploration-and-analysis}}

    \section{Genomics}\label{genomics}

    \subsubsection{Fetch Genomic Metadata}\label{fetch-genomic-metadata}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{clin\PYZus{}c\PYZus{}to\PYZus{}f}\PY{p}{,} \PY{n}{clin\PYZus{}id\PYZus{}to\PYZus{}fn} \PY{o}{=} \PY{n}{fetch\PYZus{}metadata}\PY{p}{(}\PY{n}{in\PYZus{}clin\PYZus{}manifest}\PY{p}{,} \PY{n}{out\PYZus{}clin\PYZus{}meta}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Remove annotated cases}\label{remove-annotated-cases}

cases are annotated mostly due to some confounders and would require
more complicated analysis to compensate for, so we will ignore them for
the time being

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{clin\PYZus{}c\PYZus{}to\PYZus{}f} \PY{o}{=} \PY{n}{remove\PYZus{}annotated}\PY{p}{(}\PY{n}{in\PYZus{}clin\PYZus{}data}\PY{p}{,} \PY{n}{clin\PYZus{}c\PYZus{}to\PYZus{}f}\PY{p}{,} \PY{n}{clin\PYZus{}id\PYZus{}to\PYZus{}fn}\PY{p}{)}
        \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{after removing annotated cases, our n =}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{clin\PYZus{}c\PYZus{}to\PYZus{}f}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Copy Clinical Data to
Output}\label{copy-clinical-data-to-output}

this way we retain the input as-is and can work on the output without
worrying too much.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{clin\PYZus{}to\PYZus{}output}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{copying/extracting to output folder...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{k}{for} \PY{n}{case}\PY{p}{,} \PY{n}{file} \PY{o+ow}{in} \PY{n}{clin\PYZus{}c\PYZus{}to\PYZus{}f}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{n}{in\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{in\PYZus{}clin\PYZus{}data}\PY{p}{,} \PY{n}{file}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{clin\PYZus{}id\PYZus{}to\PYZus{}fn}\PY{p}{[}\PY{n}{file}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                \PY{n}{out\PYZus{}location} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{out\PYZus{}clin\PYZus{}data}\PY{p}{,} \PY{n}{case}\PY{p}{)}
                \PY{n}{out\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{out\PYZus{}clin\PYZus{}data}\PY{p}{,} \PY{n}{case}\PY{p}{,} \PY{n}{file}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.xml}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
                \PY{n}{os}\PY{o}{.}\PY{n}{mkdir}\PY{p}{(}\PY{n}{out\PYZus{}location}\PY{p}{)}
                \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{copying file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{file}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{to output...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n}{shutil}\PY{o}{.}\PY{n}{copyfile}\PY{p}{(}\PY{n}{in\PYZus{}file}\PY{p}{,} \PY{n}{out\PYZus{}file}\PY{p}{)}
                \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{done}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{extraction complete}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{if} \PY{n}{first\PYZus{}run}\PY{p}{:} \PY{n}{clin\PYZus{}to\PYZus{}output}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Define "Left" \& "Right"}\label{define-left-right}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{anatomic\PYZus{}right} \PY{o}{=} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cecum}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ascending Colon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hepatic Flexure}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                            \PY{c+c1}{\PYZsh{} \PYZsq{}Transverse Colon\PYZsq{}}
        \PY{n}{anatomic\PYZus{}left} \PY{o}{=} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Descending Colon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sigmoid Colon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rectosigmoid Junction}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                            \PY{c+c1}{\PYZsh{}  \PYZsq{}Splenic Flexure\PYZsq{}}
\end{Verbatim}


    \subsubsection{Extract Tumor Location}\label{extract-tumor-location}

retrieve tumor location information from clinical data. some cases do
not contain anatomic location information, so we cannot use them for our
analysis

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{extract\PYZus{}tumor\PYZus{}location\PYZus{}from\PYZus{}clin}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n}{tumor\PYZus{}location} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
            \PY{n}{cases\PYZus{}without\PYZus{}location} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        
            \PY{k}{for} \PY{n}{case}\PY{p}{,} \PY{n}{file} \PY{o+ow}{in} \PY{n}{clin\PYZus{}c\PYZus{}to\PYZus{}f}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} only for clinical xml data}
                \PY{n}{file\PYZus{}loc} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{out\PYZus{}clin\PYZus{}data}\PY{p}{,} \PY{n}{case}\PY{p}{,} \PY{n}{file}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.xml}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{file\PYZus{}loc}\PY{p}{)} \PY{k}{as} \PY{n}{xmlFile}\PY{p}{:}
                    \PY{n}{tree} \PY{o}{=} \PY{n}{ET}\PY{o}{.}\PY{n}{parse}\PY{p}{(}\PY{n}{xmlFile}\PY{p}{)}
                    \PY{n}{root} \PY{o}{=} \PY{n}{tree}\PY{o}{.}\PY{n}{getroot}\PY{p}{(}\PY{p}{)}
        
                    \PY{k}{if} \PY{n}{root}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{34}\PY{p}{]}\PY{o}{.}\PY{n}{text} \PY{o}{==} \PY{k+kc}{None}\PY{p}{:}
                        \PY{n}{cases\PYZus{}without\PYZus{}location}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{case}\PY{p}{)}
                    \PY{k}{elif} \PY{n}{root}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{34}\PY{p}{]}\PY{o}{.}\PY{n}{text} \PY{o+ow}{in} \PY{n}{anatomic\PYZus{}right}\PY{p}{:}
                        \PY{n}{tumor\PYZus{}location}\PY{p}{[}\PY{n}{case}\PY{p}{]} \PY{o}{=} \PY{k+kc}{False}
                    \PY{k}{elif} \PY{n}{root}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{34}\PY{p}{]}\PY{o}{.}\PY{n}{text} \PY{o+ow}{in} \PY{n}{anatomic\PYZus{}left}\PY{p}{:}
                        \PY{n}{tumor\PYZus{}location}\PY{p}{[}\PY{n}{case}\PY{p}{]} \PY{o}{=} \PY{k+kc}{True}
        
            \PY{n}{verboseprint}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{cases\PYZus{}without\PYZus{}location}\PY{p}{)}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cases do not contain anatomic location information}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{k}{for} \PY{n}{case} \PY{o+ow}{in} \PY{n}{cases\PYZus{}without\PYZus{}location}\PY{p}{:}
                \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignoring case}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{case}\PY{p}{)}
                \PY{k}{del} \PY{n}{clin\PYZus{}c\PYZus{}to\PYZus{}f}\PY{p}{[}\PY{n}{case}\PY{p}{]}
        
            \PY{c+c1}{\PYZsh{} return as pandas Series}
            \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{tumor\PYZus{}location}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{tumor\PYZus{}location} \PY{o}{=} \PY{n}{extract\PYZus{}tumor\PYZus{}location\PYZus{}from\PYZus{}clin}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \subsection{The MAF File}\label{the-maf-file}

\subsubsection{Format}\label{format}

\begin{itemize}
\tightlist
\item
  \href{https://wiki.nci.nih.gov/display/TCGA/TCGA+MAF+Files}{Format
  specification}
\item
  \href{https://portal.gdc.cancer.gov/repository?facetTab=files\&filters=~\%28op~\%27and~content~\%28~\%28op~\%27in~content~\%28field~\%27cases.project.project_id~value~\%28~\%27TCGA-COAD\%29\%29\%29~\%28op~\%27in~content~\%28field~\%27files.data_format~value~\%28~\%27MAF\%29\%29\%29\%29\%29}{TCGA
  search result for all COAD MAF files}
\item
  \href{https://portal.gdc.cancer.gov/legacy-archive/files/3437ecf9-355d-4d35-afb4-ffe1a705c206}{Legacy
  Tumor-Normal Pair}
\end{itemize}

\subsubsection{The Problem}\label{the-problem}

cells are defined by their genes. cancers carry variations in those
genes which cause aberrant behavior. however, this causal relationship
is not one-to-one, and additionally these variations do not need to be
somatic mutations. they can be part of the individuals genome before the
cancer develops. we require some function which is capable of separating
irrelevant 'polymorphisms' from cancer-causing 'mutations'.

\subsubsection{The Solution}\label{the-solution}

The GDCs approach is the MAF file. It compares the tumor genome to the
individuals normal genome and a
\href{https://www.ncbi.nlm.nih.gov/grc/human}{reference sequence}. The
choice of reference sequence
\href{https://www.biostars.org/p/113100/}{can impact the results}. There
are multiple workflows which achieve this result

\begin{itemize}
\tightlist
\item
  varscan
\item
  mutect
\item
  muse
\item
  somaticsniper
\end{itemize}

\subsubsection{HGVSc}\label{hgvsc}

\begin{itemize}
\tightlist
\item
  stands for "Human Genome Variation Society, coding". the full
  nomenclature definition can be found
  \href{http://varnomen.hgvs.org/recommendations/DNA/}{here}. there are
  following possible suffixes.

  \begin{itemize}
  \tightlist
  \item
    "g" genomic
  \item
    "m" mitochondrial
  \item
    "c" coding DNA
  \item
    "n" non-coding DNA
  \item
    "r" RNA reference sequence (transcript)
  \item
    "p" protein reference sequence
  \end{itemize}
\item
  the HGVSc variant information is based off of reference sequences.
  these can be found in \texttt{Gene}
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} columns of maf file (without loading entire file)}
        \PY{o}{!} \PY{n+nb}{echo} \PY{n+nv}{\PYZdl{}in\PYZus{}maf\PYZus{}file}
        \PY{o}{!} head \PYZhy{}6 \PY{n+nv}{\PYZdl{}in\PYZus{}maf\PYZus{}file} \PY{p}{|} tail \PYZhy{}1 \PY{p}{|} tr \PY{l+s+s1}{\PYZsq{}\PYZbs{}t\PYZsq{}} \PY{l+s+s1}{\PYZsq{}\PYZbs{}n\PYZsq{}}
\end{Verbatim}


    \subsubsection{TODO: Reference\_Allele vs
HGVSc}\label{todo-reference_allele-vs-hgvsc}

in synonymous variant entries, the \texttt{Reference\_Allele} vs
\texttt{Allele} \textbf{differs} from the \texttt{HGVSc} notation! * for
example, for \texttt{PERM1} the alleles are \texttt{G} and \texttt{A},
but the \texttt{HGVSc} notation specifies \texttt{C\textgreater{}T}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} mutect and somaticsniper share columns}
        \PY{n}{maf\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{in\PYZus{}maf\PYZus{}file}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                    \PY{n}{usecols}\PY{o}{=}\PY{p}{[}
                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hugo\PYZus{}Symbol}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{c+c1}{\PYZsh{}                 \PYZsq{}Reference\PYZus{}Allele\PYZsq{},}
                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HGVSc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HGVSp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{c+c1}{\PYZsh{}                 \PYZsq{}Allele\PYZsq{},}
        \PY{c+c1}{\PYZsh{}                 \PYZsq{}Gene\PYZsq{},}
                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Consequence}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}
                    \PY{p}{]}\PY{p}{,}
                   \PY{n}{header}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Intersection of Sets}\label{intersection-of-sets}

some cases in the data portal do not have entries in the MAF file.
analogously, some entries in the MAF file do not seem to be associated
with any case in the current data portal version. we may only use the
intersection of these two sets.

    \texttt{tumor\_location} is derived from \texttt{clin\_c\_to\_f} -
\texttt{clin\_is\_annotated} - \texttt{cases\_without\_location}.\\
some of these cases are not present in the MAF file. therefore we cannot
use them.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{bad\PYZus{}cases} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{k}{for} \PY{n}{case} \PY{o+ow}{in} \PY{n}{tumor\PYZus{}location}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{k}{if} \PY{n}{case} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{maf\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{case}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{has no entry in MAF file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n}{bad\PYZus{}cases}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{case}\PY{p}{)}
        
        \PY{n}{tumor\PYZus{}location}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{bad\PYZus{}cases}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{k}{del} \PY{n}{bad\PYZus{}cases}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} trimmed of cases that are not in MAF}
        \PY{n}{tumor\PYZus{}location}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} maf not yet trimmed}
        \PY{n+nb}{len}\PY{p}{(}\PY{n}{maf\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} for some cases in MAF we do not have adequate data.}
        \PY{c+c1}{\PYZsh{} therefore we must remove them.}
        \PY{c+c1}{\PYZsh{} drop entries where the case\PYZus{}id is NOT (\PYZti{}) in tumor\PYZus{}location.}
        \PY{n}{entries\PYZus{}of\PYZus{}cases\PYZus{}without\PYZus{}location} \PY{o}{=} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{maf\PYZus{}df}\PY{p}{[}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{tumor\PYZus{}location}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{entries\PYZus{}of\PYZus{}cases\PYZus{}without\PYZus{}location}\PY{p}{]}\PY{o}{.}\PY{n}{case\PYZus{}id}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{entries\PYZus{}of\PYZus{}cases\PYZus{}without\PYZus{}location}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} number of cases matches trimmed location cases if == 0}
        \PY{n+nb}{len}\PY{p}{(}\PY{n}{maf\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{tumor\PYZus{}location}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{maf\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \subsubsection{Remove k- and n-RAS}\label{remove-k--and-n-ras}

\begin{itemize}
\tightlist
\item
  Mutations in these genes correlate strongly with resistance to
  anti-IgF therapy.
\item
  Hugo Symbols are \texttt{KRAS} and \texttt{NRAS}
\item
  unfortunately, this reduces our n by about 50\%
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{kRAS\PYZus{}cases} \PY{o}{=} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{maf\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hugo\PYZus{}Symbol}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KRAS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{nRAS\PYZus{}cases} \PY{o}{=} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{maf\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hugo\PYZus{}Symbol}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NRAS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{knRAS\PYZus{}cases\PYZus{}set} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{kRAS\PYZus{}cases}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)} \PY{o}{+} \PY{n}{nRAS\PYZus{}cases}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{knRAS\PYZus{}cases\PYZus{}set}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{entries\PYZus{}of\PYZus{}cases\PYZus{}with\PYZus{}knRAS\PYZus{}mutations} \PY{o}{=} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{maf\PYZus{}df}\PY{p}{[}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{knRAS\PYZus{}cases\PYZus{}set}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{index}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{entries\PYZus{}of\PYZus{}cases\PYZus{}with\PYZus{}knRAS\PYZus{}mutations}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{maf\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \subsubsection{Remove Synonymous
Variants}\label{remove-synonymous-variants}

using the \texttt{Consequence} column, value:
\texttt{synonymous\_variant}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{synonymous\PYZus{}variants} \PY{o}{=} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}
            \PY{n}{maf\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Consequence}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{synonymous\PYZus{}variant}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}
        \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{synonymous\PYZus{}variants}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{synonymous\PYZus{}variants}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \subsubsection{Unique Variant
Identifier}\label{unique-variant-identifier}

In order to completely define our mutations, we must combine multiple
columns. A complete definition can be formatted as
\texttt{Gene}:\texttt{HGVSc} * i.e. \texttt{PERM1} is
\texttt{ENSG00000187642:c.1827C\textgreater{}T}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} create unique variant ID, store in column \PYZsq{}uvi\PYZsq{}}
        \PY{c+c1}{\PYZsh{} note, there are some NaN in the data set}
        \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{uvi}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{maf\PYZus{}df}\PY{p}{[}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hugo\PYZus{}Symbol}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{maf\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HGVSc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{index}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{k+kc}{False}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{maf\PYZus{}df}\PY{p}{[}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{uvi}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} add column to end of DataFrame, left = True}
        \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{tumor\PYZus{}location}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{for} \PY{n}{case}\PY{p}{,} \PY{n}{mutations} \PY{o+ow}{in} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{uvi}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
            \PY{k}{for} \PY{n}{mut} \PY{o+ow}{in} \PY{n}{mutations}\PY{p}{:}
                \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{at}\PY{p}{[}\PY{n}{case}\PY{p}{,} \PY{n}{mut}\PY{p}{]} \PY{o}{=} \PY{k+kc}{True}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{mut\PYZus{}freq\PYZus{}histogram}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n}{df\PYZus{}left} \PY{o}{=} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{k+kc}{True}\PY{p}{]}
            \PY{n}{df\PYZus{}right} \PY{o}{=} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{k+kc}{False}\PY{p}{]}
        
            \PY{n}{df\PYZus{}left}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
            \PY{n}{df\PYZus{}right}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        
            \PY{n}{count\PYZus{}left} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{k}{for} \PY{n}{case} \PY{o+ow}{in} \PY{n}{df\PYZus{}left}\PY{o}{.}\PY{n}{index}\PY{p}{:}
                \PY{n}{count\PYZus{}left}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{df\PYZus{}left}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{case}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
        
            \PY{n}{count\PYZus{}right} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{k}{for} \PY{n}{case} \PY{o+ow}{in} \PY{n}{df\PYZus{}right}\PY{o}{.}\PY{n}{index}\PY{p}{:}
                \PY{n}{count\PYZus{}right}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{df\PYZus{}right}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{case}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
            
            \PY{n}{trace1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Histogram}\PY{p}{(}
                \PY{n}{x}\PY{o}{=}\PY{n}{count\PYZus{}left}\PY{p}{,}
                \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left\PYZhy{}sided}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                \PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.8}
                \PY{p}{)}
        
            \PY{n}{trace2} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Histogram}\PY{p}{(}
                \PY{n}{x}\PY{o}{=}\PY{n}{count\PYZus{}right}\PY{p}{,}
                \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{right\PYZhy{}sided}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                \PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.8}
                \PY{p}{)}
        
            \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{n}{trace1}\PY{p}{,} \PY{n}{trace2}\PY{p}{]}
            \PY{n}{layout} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}\PY{n}{barmode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overlay}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{data}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
        
            \PY{n}{iplot}\PY{p}{(}\PY{n}{fig}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{mut\PYZus{}freq\PYZus{}histogram}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \paragraph{Remove hypermutated cases}\label{remove-hypermutated-cases}

cases with more than 250 mutations are removed to approximately account
for MSI status

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{count} \PY{o}{=} \PY{l+m+mi}{0}
        \PY{k}{for} \PY{n}{case} \PY{o+ow}{in} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{index}\PY{p}{:}
            \PY{k}{if} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{case}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{250}\PY{p}{:}
                \PY{n}{count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{case}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{removed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{count}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cases}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \subsection{Save to Disk}\label{save-to-disk}

to save us the hassle of reevaluating every time, store finished,
assembled DataFrame to disk.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}pickle}\PY{p}{(}\PY{n}{mut\PYZus{}df\PYZus{}file}\PY{p}{,} \PY{n}{compression}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gzip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \section{Transcriptome}\label{transcriptome}

using transcriptome information from the TCGA Database, we can expand
the amount of information per case.

possibilities include * adding transcriptome information to the MAF
Dataframe, thereby expanding the dimensionality of our data set * This
could however be potentially problematic, because we would introduce
continuous values into our previously purely dichotomous data. This
could make the analysis more complicated. * creating a separate
database, running a logistic regression on that set, and comparing it to
the genomic regression. In theory it should be possible to combine the
results of both regressions to get a combined result. * associating the
variants with their corresponding transcript, and using some combination
of this data to train our classifier. * It is unclear to me how the
combined value should be calculated, and what it would represent. For
example, if there are \texttt{20} variants in gene \texttt{x1} and the
corresonding transcipt \texttt{x2} has a FPKM-UQ value of \texttt{1000}
what would the function f(x1, x2), used to combine these two bits of
information, look like?

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{in\PYZus{}trans\PYZus{}manifest} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}
            \PY{n}{input\PYZus{}dir}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{transcriptome}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{transcriptome\PYZus{}manifest.tsv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{in\PYZus{}trans\PYZus{}data} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{input\PYZus{}dir}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{transcriptome}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{out\PYZus{}trans\PYZus{}data} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{output\PYZus{}dir}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{transcriptome}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{out\PYZus{}trans\PYZus{}meta} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{output\PYZus{}dir}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{transcriptome}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{meta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{trans\PYZus{}c\PYZus{}to\PYZus{}f}\PY{p}{,} \PY{n}{trans\PYZus{}id\PYZus{}to\PYZus{}fn} \PY{o}{=} \PY{n}{fetch\PYZus{}metadata}\PY{p}{(}
            \PY{n}{in\PYZus{}trans\PYZus{}manifest}\PY{p}{,}
            \PY{n}{out\PYZus{}trans\PYZus{}meta}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{trans\PYZus{}c\PYZus{}to\PYZus{}f} \PY{o}{=} \PY{n}{remove\PYZus{}annotated}\PY{p}{(}
            \PY{n}{in\PYZus{}trans\PYZus{}data}\PY{p}{,}
            \PY{n}{trans\PYZus{}c\PYZus{}to\PYZus{}f}\PY{p}{,}
            \PY{n}{trans\PYZus{}id\PYZus{}to\PYZus{}fn}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{trans\PYZus{}c\PYZus{}to\PYZus{}f}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{bad\PYZus{}cases} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{k}{for} \PY{n}{case} \PY{o+ow}{in} \PY{n}{trans\PYZus{}c\PYZus{}to\PYZus{}f}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{k}{if} \PY{n}{case} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{index}\PY{p}{:}
                \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{case}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{case}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{has no entry in MAF file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n}{bad\PYZus{}cases}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{case}\PY{p}{)}
        
        \PY{n}{verboseprint}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{bad\PYZus{}cases}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cases will be removed from analysis}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{for} \PY{n}{case} \PY{o+ow}{in} \PY{n}{bad\PYZus{}cases}\PY{p}{:}
            \PY{n}{trans\PYZus{}c\PYZus{}to\PYZus{}f}\PY{o}{.}\PY{n}{pop}\PY{p}{(}\PY{n}{case}\PY{p}{)}
        \PY{k}{del} \PY{n}{bad\PYZus{}cases}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{trans\PYZus{}c\PYZus{}to\PYZus{}f}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{trans\PYZus{}extract\PYZus{}to\PYZus{}output}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{copying/extracting to output folder...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{k}{for} \PY{n}{case}\PY{p}{,} \PY{n}{file} \PY{o+ow}{in} \PY{n}{trans\PYZus{}c\PYZus{}to\PYZus{}f}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{n}{in\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{in\PYZus{}trans\PYZus{}data}\PY{p}{,} \PY{n}{file}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{trans\PYZus{}id\PYZus{}to\PYZus{}fn}\PY{p}{[}\PY{n}{file}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                \PY{n}{out\PYZus{}location} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{out\PYZus{}trans\PYZus{}data}\PY{p}{,} \PY{n}{case}\PY{p}{)}
                \PY{n}{out\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{out\PYZus{}trans\PYZus{}data}\PY{p}{,} \PY{n}{case}\PY{p}{,} \PY{n}{file}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
                \PY{n}{os}\PY{o}{.}\PY{n}{mkdir}\PY{p}{(}\PY{n}{out\PYZus{}location}\PY{p}{)}
                \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{copying file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{file}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{to output...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{k}{with} \PY{n}{gzip}\PY{o}{.}\PY{n}{open}\PY{p}{(}\PY{n}{in\PYZus{}file}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
                    \PY{n}{file\PYZus{}content} \PY{o}{=} \PY{n}{f}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}
                \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{out\PYZus{}file}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
                    \PY{n}{f}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{file\PYZus{}content}\PY{p}{)}
                \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{done}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{extraction complete}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{if} \PY{n}{first\PYZus{}run}\PY{p}{:} \PY{n}{trans\PYZus{}extract\PYZus{}to\PYZus{}output}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{for} \PY{n}{case} \PY{o+ow}{in} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{index}\PY{p}{:}
            \PY{k}{try}\PY{p}{:} \PY{n}{trans\PYZus{}c\PYZus{}to\PYZus{}f}\PY{p}{[}\PY{n}{case}\PY{p}{]}
            \PY{k}{except} \PY{n+ne}{KeyError}\PY{p}{:}
                \PY{n}{verboseprint}\PY{p}{(}\PY{n}{case}\PY{p}{)}
                \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{case}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{make\PYZus{}transcriptome\PYZus{}DataFrame}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n}{transcriptome} \PY{o}{=} \PY{n}{defaultdict}\PY{p}{(}\PY{n+nb}{dict}\PY{p}{)}
        
            \PY{k}{for} \PY{n}{case}\PY{p}{,} \PY{n}{file} \PY{o+ow}{in} \PY{n}{trans\PYZus{}c\PYZus{}to\PYZus{}f}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{n}{file\PYZus{}loc} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{out\PYZus{}trans\PYZus{}data}\PY{p}{,} \PY{n}{case}\PY{p}{,} \PY{n}{file}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{file\PYZus{}loc}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{tsvFile}\PY{p}{:}
                    \PY{n}{tsvData} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{reader}\PY{p}{(}\PY{n}{tsvFile}\PY{p}{,} \PY{n}{delimiter}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                    \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{tsvData}\PY{p}{:}
                        \PY{n}{transcriptome}\PY{p}{[}\PY{n}{case}\PY{p}{]}\PY{p}{[}\PY{n}{row}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
            
            \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}dict}\PY{p}{(}\PY{n}{transcriptome}\PY{p}{,} \PY{n}{orient}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{case\PYZus{}to\PYZus{}trans\PYZus{}df} \PY{o}{=} \PY{n}{make\PYZus{}transcriptome\PYZus{}DataFrame}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{case\PYZus{}to\PYZus{}trans\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{tumor\PYZus{}location}
\end{Verbatim}


    \subsection{Save to Disk}\label{save-to-disk}

to save us the hassle of reevaluating every time, store finished,
assembled DataFrame to disk.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{case\PYZus{}to\PYZus{}trans\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}pickle}\PY{p}{(}\PY{n}{trans\PYZus{}df\PYZus{}file}\PY{p}{,} \PY{n}{compression}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gzip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \section{Exploration and Analysis}\label{exploration-and-analysis}

    \subsubsection{Naming Convention}\label{naming-convention}

\texttt{X} is the information we give the regression model, \texttt{y}
is the correct result.

\subsubsection{t-Distributed Stochastic Neighbor
Embedding}\label{t-distributed-stochastic-neighbor-embedding}

We can use t-SNE to visualize our dataset in 2 or 3 dimensions, to try
to gain further insight into our data set. It is useful for quickly
reducing the dimensionality of a dataset without any prior insight. In
this example, 3 dimensions are used. this can be chosen using the
\texttt{n\_components} variable. The model reduces high-dimensional
datasets to something that humans are capable of comprehending. May
yield different results on repeated runs.

\subsection{Logistic Regression}\label{logistic-regression}

A binary logistic regressor, using nested cross-validation. * Outer CV *
Sample Selection: Stratified k-fold * Scoring: \textbf{R}eceiver
\textbf{O}perating \textbf{C}haracteristic \textbf{A}rea \textbf{U}nder
the \textbf{C}urve * Inner CV * Hyperparameter \texttt{C} is assessed
for \texttt{n\_inner\_folds} (default: 10) logarithmically spaced values
between 10-4 and 104 * Sample Selection: Stratified k-fold * Scoring:
Accuracy

\subsection{Random Forest}\label{random-forest}

A binary classifier based on random subsampling and decision trees.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k}{def} \PY{n+nf}{get\PYZus{}n\PYZus{}colors}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}return list of colors from viridis colorspace for use with plotly\PYZdq{}\PYZdq{}\PYZdq{}}
            
            \PY{n}{cmap} \PY{o}{=} \PY{n}{get\PYZus{}cmap}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{viridis}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{colors\PYZus{}01} \PY{o}{=} \PY{n}{cmap}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{n}\PY{p}{)}\PY{p}{)}
            \PY{n}{colors\PYZus{}255} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        
            \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{colors\PYZus{}01}\PY{p}{:}
                \PY{n}{colors\PYZus{}255}\PY{o}{.}\PY{n}{append}\PY{p}{(}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rgba(}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{, }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{, }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{, }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                        \PY{n}{row}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{255}\PY{p}{,}
                        \PY{n}{row}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{255}\PY{p}{,}
                        \PY{n}{row}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{255}\PY{p}{,}
                        \PY{n}{row}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}
                        \PY{p}{)}
                    \PY{p}{)}
        
            \PY{k}{return} \PY{n}{colors\PYZus{}255}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k}{def} \PY{n+nf}{tsne}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{:}
        
            \PY{n}{tsne} \PY{o}{=} \PY{n}{TSNE}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{perplexity}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}
        
            \PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
            \PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
            \PY{n}{X\PYZus{}3d} \PY{o}{=} \PY{n}{tsne}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
        
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{t\PYZhy{}SNE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{verboseprint}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reduced dimensionality from }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ to }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ dimensions}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                \PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{X\PYZus{}3d}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                \PY{p}{)}
            \PY{p}{)}
        
            \PY{n}{trace\PYZus{}true} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Scatter3d}\PY{p}{(}
                \PY{n}{x} \PY{o}{=} \PY{n}{X\PYZus{}3d}\PY{p}{[}\PY{n}{y}\PY{o}{==}\PY{k+kc}{True}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
                \PY{n}{y} \PY{o}{=} \PY{n}{X\PYZus{}3d}\PY{p}{[}\PY{n}{y}\PY{o}{==}\PY{k+kc}{True}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                \PY{n}{z} \PY{o}{=} \PY{n}{X\PYZus{}3d}\PY{p}{[}\PY{n}{y}\PY{o}{==}\PY{k+kc}{True}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}
                \PY{n}{name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                \PY{n}{mode} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{markers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                \PY{n}{marker} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}
                    \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rgba(37, 146, 34, 0.8)}\PY{l+s+s1}{\PYZsq{}}
                    \PY{p}{)}\PY{p}{,}
                \PY{n}{text} \PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{n}{y}\PY{o}{==}\PY{k+kc}{True}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
                \PY{p}{)}
            \PY{n}{trace\PYZus{}false} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Scatter3d}\PY{p}{(}
                \PY{n}{x} \PY{o}{=} \PY{n}{X\PYZus{}3d}\PY{p}{[}\PY{n}{y}\PY{o}{==}\PY{k+kc}{False}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
                \PY{n}{y} \PY{o}{=} \PY{n}{X\PYZus{}3d}\PY{p}{[}\PY{n}{y}\PY{o}{==}\PY{k+kc}{False}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                \PY{n}{z} \PY{o}{=} \PY{n}{X\PYZus{}3d}\PY{p}{[}\PY{n}{y}\PY{o}{==}\PY{k+kc}{False}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}
                \PY{n}{name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                \PY{n}{mode} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{markers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                \PY{n}{marker} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}
                    \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rgba(209, 28, 36, 0.8)}\PY{l+s+s1}{\PYZsq{}}
                    \PY{p}{)}\PY{p}{,}
                \PY{n}{text} \PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{n}{y}\PY{o}{==}\PY{k+kc}{False}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
                \PY{p}{)}
            \PY{n}{layout} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{t\PYZhy{}SNE Representation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{p}{[}\PY{n}{trace\PYZus{}true}\PY{p}{,} \PY{n}{trace\PYZus{}false}\PY{p}{]}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
        
            \PY{n}{iplot}\PY{p}{(}\PY{n}{fig}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{class} \PY{n+nc}{logit\PYZus{}clf}\PY{p}{:}
            \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{df}\PY{p}{,} \PY{n}{n\PYZus{}inner\PYZus{}folds}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{,} \PY{n}{n\PYZus{}outer\PYZus{}folds}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{v}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
        
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df} \PY{o}{=} \PY{n}{df}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}outer\PYZus{}folds} \PY{o}{=} \PY{n}{n\PYZus{}outer\PYZus{}folds}
                
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}
                                        \PY{n}{Cs}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,}
                                        \PY{n}{fit\PYZus{}intercept}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                        \PY{n}{cv}\PY{o}{=}\PY{n}{n\PYZus{}inner\PYZus{}folds}\PY{p}{,}
                                        \PY{n}{dual}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                        \PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                        \PY{n}{solver}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{liblinear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                        \PY{n}{tol}\PY{o}{=}\PY{l+m+mf}{0.0001}\PY{p}{,}
                                        \PY{n}{max\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,}
                                        \PY{n}{class\PYZus{}weight}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                                        \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}
                                        \PY{n}{verbose}\PY{o}{=}\PY{n}{v}\PY{p}{,}
                                        \PY{n}{refit}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                        \PY{n}{intercept\PYZus{}scaling}\PY{o}{=}\PY{l+m+mf}{1.0}\PY{p}{,}
                                        \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{3257}
                                        \PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cv} \PY{o}{=} \PY{n}{StratifiedKFold}\PY{p}{(}
                    \PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}outer\PYZus{}folds}\PY{p}{,}
                    \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{5235}\PY{p}{)}
        
            \PY{k}{def} \PY{n+nf}{fit\PYZus{}and\PYZus{}print\PYZus{}roc}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                \PY{n}{tprs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{n}{aucs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{n}{mean\PYZus{}fpr} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
        
                \PY{n}{plotly\PYZus{}data} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        
                \PY{n}{colors} \PY{o}{=} \PY{n}{get\PYZus{}n\PYZus{}colors}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}outer\PYZus{}folds}\PY{p}{)}
                
                \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{0}
                \PY{k}{for} \PY{n}{train}\PY{p}{,} \PY{n}{test} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cv}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{)}\PY{p}{:}
                    \PY{n}{probabilities\PYZus{}} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{fit}\PY{p}{(}
                                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train}\PY{p}{]}\PY{p}{,}
                                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train}\PY{p}{]}
                                        \PY{p}{)}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test}\PY{p}{]}\PY{p}{)}
        
                    \PY{c+c1}{\PYZsh{} Compute ROC curve and area under the curve}
                    \PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}
                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test}\PY{p}{]}\PY{p}{,}
                        \PY{n}{probabilities\PYZus{}}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                    \PY{n}{tprs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{interp}\PY{p}{(}\PY{n}{mean\PYZus{}fpr}\PY{p}{,} \PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{)}\PY{p}{)}
                    \PY{n}{tprs}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mf}{0.0}
                    \PY{n}{roc\PYZus{}auc} \PY{o}{=} \PY{n}{auc}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{)}
                    \PY{n}{aucs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{roc\PYZus{}auc}\PY{p}{)}
                    \PY{n}{plotly\PYZus{}data}\PY{o}{.}\PY{n}{append}\PY{p}{(}
                        \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
                            \PY{n}{x}\PY{o}{=}\PY{n}{fpr}\PY{p}{,}
                            \PY{n}{y}\PY{o}{=}\PY{n}{tpr}\PY{p}{,}
                            \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ROC fold }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ (AUC = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                                \PY{n}{i}\PY{p}{,} \PY{n+nb}{round}\PY{p}{(}\PY{n}{roc\PYZus{}auc}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                            \PY{n}{line}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{n}{colors}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                            \PY{p}{)}
                        \PY{p}{)}
                    \PY{n}{i} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        
                \PY{c+c1}{\PYZsh{} add ROC reference line}
                \PY{n}{plotly\PYZus{}data}\PY{o}{.}\PY{n}{append}\PY{p}{(}
                    \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
                        \PY{n}{x}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                        \PY{n}{y}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                        \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{line}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}
                            \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{navy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                            \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
                            \PY{n}{dash}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dash}\PY{l+s+s1}{\PYZsq{}}
                            \PY{p}{)}\PY{p}{,}
                        \PY{n}{showlegend}\PY{o}{=}\PY{k+kc}{False}
                        \PY{p}{)}
                    \PY{p}{)}
        
                        \PY{c+c1}{\PYZsh{} mean}
                \PY{n}{mean\PYZus{}tpr} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{tprs}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                \PY{n}{mean\PYZus{}tpr}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{l+m+mf}{1.0}
                \PY{n}{mean\PYZus{}auc} \PY{o}{=} \PY{n}{auc}\PY{p}{(}\PY{n}{mean\PYZus{}fpr}\PY{p}{,} \PY{n}{mean\PYZus{}tpr}\PY{p}{)}
                \PY{n}{std\PYZus{}auc} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{aucs}\PY{p}{)}
        
                \PY{c+c1}{\PYZsh{} Standard Deviation}
                \PY{n}{std\PYZus{}tpr} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{tprs}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                \PY{n}{tprs\PYZus{}upper} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{minimum}\PY{p}{(}\PY{n}{mean\PYZus{}tpr} \PY{o}{+} \PY{n}{std\PYZus{}tpr}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
                \PY{n}{tprs\PYZus{}lower} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{maximum}\PY{p}{(}\PY{n}{mean\PYZus{}tpr} \PY{o}{\PYZhy{}} \PY{n}{std\PYZus{}tpr}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}
                \PY{n}{plotly\PYZus{}data}\PY{o}{.}\PY{n}{append}\PY{p}{(}
                    \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
                        \PY{n}{x}\PY{o}{=}\PY{n}{mean\PYZus{}fpr}\PY{p}{,}
                        \PY{n}{y}\PY{o}{=}\PY{n}{tprs\PYZus{}upper}\PY{p}{,}
                        \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper bound}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{line}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grey}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                        \PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,}
                        \PY{n}{showlegend}\PY{o}{=}\PY{k+kc}{False}
                        \PY{p}{)}
                    \PY{p}{)}
                \PY{c+c1}{\PYZsh{} plot mean above std deviation}
                \PY{n}{plotly\PYZus{}data}\PY{o}{.}\PY{n}{append}\PY{p}{(}
                    \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
                        \PY{n}{x}\PY{o}{=}\PY{n}{mean\PYZus{}fpr}\PY{p}{,}
                        \PY{n}{y}\PY{o}{=}\PY{n}{tprs\PYZus{}lower}\PY{p}{,}
                        \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{± 1 std. dev.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{fill}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tonexty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{line}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grey}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                        \PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.1}
                        \PY{p}{)}
                    \PY{p}{)}
        
                \PY{n}{plotly\PYZus{}data}\PY{o}{.}\PY{n}{append}\PY{p}{(}
                    \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
                        \PY{n}{x}\PY{o}{=}\PY{n}{mean\PYZus{}fpr}\PY{p}{,}
                        \PY{n}{y}\PY{o}{=}\PY{n}{mean\PYZus{}tpr}\PY{p}{,}
                        \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean ROC (AUC = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ ± }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                            \PY{n+nb}{round}\PY{p}{(}\PY{n}{mean\PYZus{}auc}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,}
                            \PY{n+nb}{round}\PY{p}{(}\PY{n}{std\PYZus{}auc}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
                            \PY{p}{)}\PY{p}{,}
                        \PY{n}{line}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkorange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}
                        \PY{p}{)}
                    \PY{p}{)}
                
                \PY{n}{layout} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Receiver operating characteristic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                           \PY{n}{xaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                           \PY{n}{yaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                           \PY{p}{)}
                \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{plotly\PYZus{}data}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
        
                \PY{n}{iplot}\PY{p}{(}\PY{n}{fig}\PY{p}{)}
        
            \PY{k}{def} \PY{n+nf}{get\PYZus{}n\PYZus{}pos\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{r\PYZus{}min}\PY{p}{,} \PY{n}{r\PYZus{}max}\PY{p}{,} \PY{n}{n}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
                \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Return Variants whose Regression Coefficients are largest.}
        
        \PY{l+s+sd}{        assumes that the target class is `left`.}
        \PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
                \PY{n}{coefs} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{)}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{coefs}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
                \PY{n}{n\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{:}
                    \PY{n}{n\PYZus{}indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        
                \PY{k}{if} \PY{n}{plot}\PY{p}{:}
                    \PY{n}{trace1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{y}\PY{o}{=}\PY{n}{coefs}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{text} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                   \PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}
                                  \PY{p}{)}
        
                    \PY{n}{layout} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}
                        \PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Positive Regression Coefficients}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                        \PY{n}{yaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{range}\PY{o}{=}\PY{p}{[}\PY{n}{r\PYZus{}min}\PY{p}{,} \PY{n}{r\PYZus{}max}\PY{p}{]}\PY{p}{)}
                    \PY{p}{)}
                    \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{p}{[}\PY{n}{trace1}\PY{p}{]}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
        
                    \PY{n}{iplot}\PY{p}{(}\PY{n}{fig}\PY{p}{)}
        
            \PY{k}{def} \PY{n+nf}{get\PYZus{}n\PYZus{}neg\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{r\PYZus{}min}\PY{p}{,} \PY{n}{r\PYZus{}max}\PY{p}{,} \PY{n}{n}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
                \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Return Variants whose Regression Coefficients are largest.}
        
        \PY{l+s+sd}{        assumes that the target class is `left`.}
        \PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
                \PY{n}{coefs} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{)}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{coefs}\PY{p}{)}
        
                \PY{n}{n\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{:}
                    \PY{n}{n\PYZus{}indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        
                \PY{k}{if} \PY{n}{plot}\PY{p}{:}
                    \PY{n}{trace1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{y}\PY{o}{=}\PY{n}{coefs}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{text} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                   \PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}
                                  \PY{p}{)}
        
                    \PY{n}{layout} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}
                        \PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Negative Regression Coefficients}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                        \PY{n}{yaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{range}\PY{o}{=}\PY{p}{[}\PY{n}{r\PYZus{}min}\PY{p}{,} \PY{n}{r\PYZus{}max}\PY{p}{]}\PY{p}{)}
                    \PY{p}{)}
                    \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{p}{[}\PY{n}{trace1}\PY{p}{]}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
        
                    \PY{n}{iplot}\PY{p}{(}\PY{n}{fig}\PY{p}{)}
        
            \PY{k}{def} \PY{n+nf}{get\PYZus{}n\PYZus{}most\PYZus{}sided}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{n}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}return two dicts, right and left, each with n case UUIDs}
        \PY{l+s+sd}{        and respective P(right\PYZhy{}sidedness) \PYZhy{} P(left\PYZhy{}sidedness), where}
        \PY{l+s+sd}{        this value is minimal in the classifier.}
        
        \PY{l+s+sd}{        the classifier must be fit() before using this function.}
        \PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
        
                \PY{c+c1}{\PYZsh{} The order of the classes in probas corresponds to that}
                \PY{c+c1}{\PYZsh{} in the attribute classes\PYZus{}, in this case [False, True]}
        
                \PY{n}{probas} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{)}
                \PY{n}{proba\PYZus{}diffs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{probas}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{probas}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
        
                \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{proba\PYZus{}diffs}\PY{p}{)}
        
                \PY{n}{left\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{n}{right\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{:}
                    \PY{n}{left\PYZus{}indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                    \PY{n}{right\PYZus{}indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{flip}\PY{p}{(}\PY{n}{indices}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        
                \PY{n}{right} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{right\PYZus{}indices}\PY{p}{:}
                    \PY{n}{case\PYZus{}id} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                    \PY{n}{proba\PYZus{}diff} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{proba\PYZus{}diffs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}
                    \PY{n}{right}\PY{p}{[}\PY{n}{case\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{n}{proba\PYZus{}diff}
        
                \PY{n}{left} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{left\PYZus{}indices}\PY{p}{:}
                    \PY{n}{case\PYZus{}id} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                    \PY{n}{proba\PYZus{}diff} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{proba\PYZus{}diffs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}
                    \PY{n}{left}\PY{p}{[}\PY{n}{case\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{n}{proba\PYZus{}diff}
        
                \PY{k}{return} \PY{n}{right}\PY{p}{,} \PY{n}{left}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{class} \PY{n+nc}{rf\PYZus{}clf}\PY{p}{:}
            \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{df}\PY{p}{,} \PY{n}{n\PYZus{}trees}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{v}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df} \PY{o}{=} \PY{n}{df}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}
                                        \PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{n\PYZus{}trees}\PY{p}{,}
                                        \PY{n}{criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                        \PY{n}{max\PYZus{}features}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqrt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                        \PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                                        \PY{n}{min\PYZus{}samples\PYZus{}split}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
                                        \PY{n}{min\PYZus{}samples\PYZus{}leaf}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
                                        \PY{n}{min\PYZus{}weight\PYZus{}fraction\PYZus{}leaf}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
                                        \PY{n}{max\PYZus{}leaf\PYZus{}nodes}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                                        \PY{n}{min\PYZus{}impurity\PYZus{}decrease}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
                                        \PY{n}{min\PYZus{}impurity\PYZus{}split}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                                        \PY{n}{bootstrap}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                        \PY{n}{oob\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                        \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}
                                        \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{3576}\PY{p}{,}
                                        \PY{n}{verbose}\PY{o}{=}\PY{n}{v}\PY{p}{,}
                                        \PY{n}{warm\PYZus{}start}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                        \PY{n}{class\PYZus{}weight}\PY{o}{=}\PY{k+kc}{None}
                                        \PY{p}{)}
            \PY{k}{def} \PY{n+nf}{fit}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{)}
        
            \PY{k}{def} \PY{n+nf}{print\PYZus{}roc}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                \PY{n}{tprs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{n}{aucs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{n}{mean\PYZus{}fpr} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
        
                \PY{n}{y\PYZus{}decision} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{oob\PYZus{}decision\PYZus{}function\PYZus{}}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
                \PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{y\PYZus{}decision}\PY{p}{)}
                \PY{n}{roc\PYZus{}auc} \PY{o}{=} \PY{n}{auc}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{)}
        
                \PY{n}{trace0} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
                    \PY{n}{x}\PY{o}{=}\PY{n}{fpr}\PY{p}{,}
                    \PY{n}{y}\PY{o}{=}\PY{n}{tpr}\PY{p}{,}
                    \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ROC AUC = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{roc\PYZus{}auc}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                    \PY{n}{line}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkorange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
                    \PY{p}{)}
                \PY{n}{trace1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
                    \PY{n}{x}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                    \PY{n}{y}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                    \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                    \PY{n}{line}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{navy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{dash}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dash}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                    \PY{n}{showlegend}\PY{o}{=}\PY{k+kc}{False}
                    \PY{p}{)}
                \PY{n}{layout} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}
                            \PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Receiver operating characteristic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                            \PY{n}{xaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                            \PY{n}{yaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                            \PY{p}{)}
        
                \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{n}{trace0}\PY{p}{,} \PY{n}{trace1}\PY{p}{]}
                \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{data}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
        
                \PY{n}{iplot}\PY{p}{(}\PY{n}{fig}\PY{p}{)}
        
            \PY{k}{def} \PY{n+nf}{get\PYZus{}n\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{n}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
                \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Return Variants IDs deemed most important by the Classifier.}
        
        \PY{l+s+sd}{        Metric used by rf clf is (by default) `gini impurity`, or}
        \PY{l+s+sd}{        if specified, entropy gain.}
        \PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
                \PY{k}{def} \PY{n+nf}{std\PYZus{}dev\PYZus{}of\PYZus{}features}\PY{p}{(}\PY{n}{n}\PY{o}{=}\PY{l+m+mi}{8000}\PY{p}{)}\PY{p}{:}
                    \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}use chunking to get std dev in memory\PYZhy{}efficient way}
        
        \PY{l+s+sd}{            For large numbers of features and large numbers of trees,}
        \PY{l+s+sd}{            the memory required to store the input matrix for np.std becomes}
        \PY{l+s+sd}{            unfeasable. Here, the approach is to scan through all trees}
        \PY{l+s+sd}{            multiple times, selecting only a batch of features at a time}
        \PY{l+s+sd}{            and then calculating the std dev on that batch. This way we avoid}
        \PY{l+s+sd}{            loading the entire matrix of possibilities into memory at once.}
        \PY{l+s+sd}{            \PYZdq{}\PYZdq{}\PYZdq{}}
        
                    \PY{n}{std} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{n}\PY{p}{)}\PY{p}{:}
                        \PY{n}{chunk\PYZus{}buffer} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                        \PY{k}{for} \PY{n}{tree} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{estimators\PYZus{}}\PY{p}{:}
                            \PY{n}{chunk\PYZus{}buffer}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tree}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{:}\PY{n}{i}\PY{o}{+}\PY{n}{n}\PY{p}{]}\PY{p}{)}
                        \PY{n}{std}\PY{p}{[}\PY{n}{i}\PY{p}{:}\PY{n}{i}\PY{o}{+}\PY{n}{n}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{chunk\PYZus{}buffer}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                        \PY{k}{del} \PY{n}{chunk\PYZus{}buffer}
        
                    \PY{k}{return} \PY{n}{std}
        
                \PY{n}{std} \PY{o}{=} \PY{n}{std\PYZus{}dev\PYZus{}of\PYZus{}features}\PY{p}{(}\PY{p}{)}
                \PY{n}{importances} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}
                \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{flip}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{importances}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}
        
                \PY{n}{n\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{:}
                    \PY{n}{n\PYZus{}indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        
                \PY{k}{if} \PY{n}{plot}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} plotly}
                    \PY{n}{trace} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{y}\PY{o}{=}\PY{n}{importances}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{text} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                   \PY{n}{error\PYZus{}y}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}
                                       \PY{n}{visible}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                       \PY{n}{arrayminus}\PY{o}{=}\PY{n}{std}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                                   \PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}
                                  \PY{p}{)}
        
                    \PY{n}{layout} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Feature importance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                    \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{p}{[}\PY{n}{trace}\PY{p}{]}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
        
                    \PY{n}{iplot}\PY{p}{(}\PY{n}{fig}\PY{p}{)}
                
                \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{n\PYZus{}indices}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
        
            \PY{k}{def} \PY{n+nf}{get\PYZus{}n\PYZus{}most\PYZus{}sided}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{n}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}return two dicts, right and left, each with n case UUIDs}
        \PY{l+s+sd}{        and respective P(right\PYZhy{}sidedness) \PYZhy{} P(left\PYZhy{}sidedness), where}
        \PY{l+s+sd}{        this value is minimal in the classifier.}
        
        \PY{l+s+sd}{        the classifier must be fit() before using this function.}
        \PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
        
                \PY{c+c1}{\PYZsh{} The order of the classes in probas corresponds to that}
                \PY{c+c1}{\PYZsh{} in the attribute classes\PYZus{}, in this case [False, True]}
        
                \PY{n}{probas} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{)}
                \PY{n}{proba\PYZus{}diffs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{probas}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{probas}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
        
                \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{proba\PYZus{}diffs}\PY{p}{)}
        
                \PY{n}{left\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{n}{right\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{:}
                    \PY{n}{left\PYZus{}indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                    \PY{n}{right\PYZus{}indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{flip}\PY{p}{(}\PY{n}{indices}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        
                \PY{n}{right} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{right\PYZus{}indices}\PY{p}{:}
                    \PY{n}{case\PYZus{}id} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                    \PY{n}{proba\PYZus{}diff} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{proba\PYZus{}diffs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}
                    \PY{n}{right}\PY{p}{[}\PY{n}{case\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{n}{proba\PYZus{}diff}
        
                \PY{n}{left} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{left\PYZus{}indices}\PY{p}{:}
                    \PY{n}{case\PYZus{}id} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{df}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                    \PY{n}{proba\PYZus{}diff} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{proba\PYZus{}diffs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}
                    \PY{n}{left}\PY{p}{[}\PY{n}{case\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{n}{proba\PYZus{}diff}
        
                \PY{k}{return} \PY{n}{right}\PY{p}{,} \PY{n}{left}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{tsne}\PY{p}{(}\PY{n}{case\PYZus{}to\PYZus{}trans\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
t-SNE
-----

reduced dimensionality from 60483 to 3 dimensions

    \end{Verbatim}

    
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{mut\PYZus{}logit\PYZus{}clf} \PY{o}{=} \PY{n}{logit\PYZus{}clf}\PY{p}{(}\PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{p}{)}
        \PY{n}{mut\PYZus{}logit\PYZus{}clf}\PY{o}{.}\PY{n}{fit\PYZus{}and\PYZus{}print\PYZus{}roc}\PY{p}{(}\PY{p}{)}
        \PY{n}{mut\PYZus{}logit\PYZus{}important} \PY{o}{=} \PY{n}{mut\PYZus{}logit\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{p}{)}
        \PY{n}{mut\PYZus{}logit\PYZus{}sided} \PY{o}{=} \PY{n}{mut\PYZus{}logit\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}most\PYZus{}sided}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{forest\PYZus{}size} \PY{o}{=} \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{/}\PY{o}{/} \PY{l+m+mi}{4}
        \PY{n}{mut\PYZus{}rf\PYZus{}clf} \PY{o}{=} \PY{n}{rf\PYZus{}clf}\PY{p}{(}\PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{p}{,} \PY{n}{n\PYZus{}trees}\PY{o}{=}\PY{n}{forest\PYZus{}size}\PY{p}{,} \PY{n}{v}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{mut\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
        \PY{n}{mut\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{print\PYZus{}roc}\PY{p}{(}\PY{p}{)}
        \PY{n}{mut\PYZus{}rf\PYZus{}important} \PY{o}{=} \PY{n}{mut\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{p}{)}
        \PY{n}{mut\PYZus{}rf\PYZus{}sided} \PY{o}{=} \PY{n}{mut\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}most\PYZus{}sided}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{trans\PYZus{}logit\PYZus{}clf} \PY{o}{=} \PY{n}{logit\PYZus{}clf}\PY{p}{(}\PY{n}{case\PYZus{}to\PYZus{}trans\PYZus{}df}\PY{p}{,} \PY{n}{v}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{trans\PYZus{}logit\PYZus{}clf}\PY{o}{.}\PY{n}{fit\PYZus{}and\PYZus{}print\PYZus{}roc}\PY{p}{(}\PY{p}{)}
        \PY{n}{trans\PYZus{}logit\PYZus{}important} \PY{o}{=} \PY{n}{trans\PYZus{}logit\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{p}{)}
        \PY{n}{trans\PYZus{}logit\PYZus{}sided} \PY{o}{=} \PY{n}{trans\PYZus{}logit\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}most\PYZus{}sided}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{forest\PYZus{}size} \PY{o}{=} \PY{n}{case\PYZus{}to\PYZus{}trans\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{/}\PY{o}{/} \PY{l+m+mi}{4}
        \PY{n}{trans\PYZus{}rf\PYZus{}clf} \PY{o}{=} \PY{n}{rf\PYZus{}clf}\PY{p}{(}\PY{n}{case\PYZus{}to\PYZus{}trans\PYZus{}df}\PY{p}{,} \PY{n}{v}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{trans\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
        \PY{n}{trans\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{print\PYZus{}roc}\PY{p}{(}\PY{p}{)}
        \PY{n}{trans\PYZus{}rf\PYZus{}important} \PY{o}{=} \PY{n}{trans\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{p}{)}
        \PY{n}{trans\PYZus{}rf\PYZus{}sided} \PY{o}{=} \PY{n}{trans\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}most\PYZus{}sided}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \textbf{TODO} we can get the \texttt{n} cases which best represent left-
or right-sidedness by finding \texttt{P(left)\ -\ P(right)}. Then, we
take the case UUIDs and download the slides from the legacy TCGA. Prof.
Kirchner can then typify them.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{import} \PY{n+nn}{pickle}
\end{Verbatim}


    \subsection{Save Classifiers to Disk}\label{save-classifiers-to-disk}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./out/classifiers/mut\PYZus{}logit\PYZus{}clf.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} Pickle the \PYZsq{}data\PYZsq{} dictionary using the highest protocol available.}
            \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{mut\PYZus{}logit\PYZus{}clf}\PY{p}{,} \PY{n}{f}\PY{p}{,} \PY{n}{pickle}\PY{o}{.}\PY{n}{HIGHEST\PYZus{}PROTOCOL}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./out/classifiers/mut\PYZus{}rf\PYZus{}clf.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} Pickle the \PYZsq{}data\PYZsq{} dictionary using the highest protocol available.}
            \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{mut\PYZus{}rf\PYZus{}clf}\PY{p}{,} \PY{n}{f}\PY{p}{,} \PY{n}{pickle}\PY{o}{.}\PY{n}{HIGHEST\PYZus{}PROTOCOL}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./out/classifiers/trans\PYZus{}logit\PYZus{}clf.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} Pickle the \PYZsq{}data\PYZsq{} dictionary using the highest protocol available.}
            \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{trans\PYZus{}logit\PYZus{}clf}\PY{p}{,} \PY{n}{f}\PY{p}{,} \PY{n}{pickle}\PY{o}{.}\PY{n}{HIGHEST\PYZus{}PROTOCOL}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./out/classifiers/trans\PYZus{}rf\PYZus{}clf.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} Pickle the \PYZsq{}data\PYZsq{} dictionary using the highest protocol available.}
            \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{trans\PYZus{}rf\PYZus{}clf}\PY{p}{,} \PY{n}{f}\PY{p}{,} \PY{n}{pickle}\PY{o}{.}\PY{n}{HIGHEST\PYZus{}PROTOCOL}\PY{p}{)}
\end{Verbatim}


    \subsection{Retrieve Classifiers from
Disk}\label{retrieve-classifiers-from-disk}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Mutation Logistic Regression}
        \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./out/classifiers/mut\PYZus{}logit\PYZus{}clf.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
            \PY{n}{unpickler} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{Unpickler}\PY{p}{(}\PY{n}{f}\PY{p}{)}
            \PY{n}{mut\PYZus{}logit\PYZus{}clf} \PY{o}{=} \PY{n}{unpickler}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Mutation RandomForest}
        \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./out/classifiers/mut\PYZus{}rf\PYZus{}clf.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
            \PY{n}{unpickler} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{Unpickler}\PY{p}{(}\PY{n}{f}\PY{p}{)}
            \PY{n}{mut\PYZus{}rf\PYZus{}clf} \PY{o}{=} \PY{n}{unpickler}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Transcriptome Logistic Regression}
        \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./out/classifiers/trans\PYZus{}logit\PYZus{}clf.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
            \PY{n}{unpickler} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{Unpickler}\PY{p}{(}\PY{n}{f}\PY{p}{)}
            \PY{n}{trans\PYZus{}logit\PYZus{}clf} \PY{o}{=} \PY{n}{unpickler}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Transcriptome RandomForest}
        \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./out/classifiers/trans\PYZus{}rf\PYZus{}clf.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
            \PY{n}{unpickler} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{Unpickler}\PY{p}{(}\PY{n}{f}\PY{p}{)}
            \PY{n}{trans\PYZus{}rf\PYZus{}clf} \PY{o}{=} \PY{n}{unpickler}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{mut\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}
            \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{mut\PYZus{}logit\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}pos\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{n}{r\PYZus{}min}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{r\PYZus{}max}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{mut\PYZus{}logit\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}neg\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{n}{r\PYZus{}min}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{8}\PY{p}{,} \PY{n}{r\PYZus{}max}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{trans\PYZus{}logit\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}pos\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{n}{r\PYZus{}min}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{r\PYZus{}max}\PY{o}{=}\PY{l+m+mf}{0.000004}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{trans\PYZus{}logit\PYZus{}clf}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}neg\PYZus{}most\PYZus{}important}\PY{p}{(}\PY{n}{r\PYZus{}min}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.000004}\PY{p}{,} \PY{n}{r\PYZus{}max}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}
            \PY{n}{mut\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}
                \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{[}
                \PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{mut\PYZus{}rf\PYZus{}clf}\PY{o}{.}\PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}
                \PY{n}{case\PYZus{}to\PYZus{}mut\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tumor\PYZus{}loc\PYZus{}left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{p}{)}
\end{Verbatim}


    \subsection{Variant Information}\label{variant-information}

\begin{itemize}
\tightlist
\item
  using the \href{https://api.varsome.com/}{VarSome} search engine API,
  we can retrieve a large amount of information about our variants.
\item
  \href{https://github.com/saphetor/variant-api-client-python}{Reference
  API Client} written in Python, hosted on GitHub
\end{itemize}

    \paragraph{Available GET Parameters}\label{available-get-parameters}

params are passed as dict with key value pairs, for example\\
\texttt{params=\{\textquotesingle{}expand-pubmed-articles\textquotesingle{}:\ 1,\ \textquotesingle{}add-source-databases\textquotesingle{}:\ \textquotesingle{}gerp,wustl-civic\textquotesingle{}\}}

\begin{itemize}
\tightlist
\item
  \texttt{add-all-data} = 1 or 0
\item
  \texttt{add-region-databases} = 1 or 0
\item
  \texttt{expand-pubmed-articles} = 1 or 0
\item
  \texttt{add-main-data-points} = 1 or 0
\item
  \texttt{add-source-databases} = all or none or

  \begin{itemize}
  \tightlist
  \item
    gerp
  \item
    wustl-civic
  \item
    ncbi-dbsnp
  \item
    ensembl-transcripts
  \item
    broad-exac
  \item
    dbnsfp-dbscsnv
  \item
    gwas
  \item
    ncbi-clinvar
  \item
    gnomad-genomes
  \item
    dbnsfp
  \item
    sanger-cosmic
  \item
    dann-snvs
  \item
    sanger-cosmic-public
  \item
    gnomad-exomes
  \item
    ncbi-clinvar2
  \item
    refseq-transcripts
  \item
    uniprot-variants
  \item
    gnomad-genomes-coverage
  \item
    gnomad-exomes-coverage
  \item
    thousand-genomes
  \item
    isb-kaviar3
  \item
    iarc-tp53-germline
  \item
    sanger-cosmic-licensed
  \item
    iarc-tp53-somatic
  \item
    icgc-somatic
  \end{itemize}
\item
  \texttt{allele-frequency-threshold} = float
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{from} \PY{n+nn}{variantapi}\PY{n+nn}{.}\PY{n+nn}{client} \PY{k}{import} \PY{n}{VariantAPIClient}
        \PY{n}{varsome\PYZus{}api\PYZus{}key} \PY{o}{=} \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{varsome\PYZus{}api\PYZus{}key\PYZus{}file}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:} \PY{n}{f}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}
        \PY{n}{varsome\PYZus{}api} \PY{o}{=} \PY{n}{VariantAPIClient}\PY{p}{(}\PY{n}{varsome\PYZus{}api\PYZus{}key}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{result} \PY{o}{=} \PY{n}{varsome\PYZus{}api}\PY{o}{.}\PY{n}{batch\PYZus{}lookup}\PY{p}{(}
            \PY{n+nb}{list}\PY{p}{(}\PY{n}{significant\PYZus{}var\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
            \PY{n}{params}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{add\PYZhy{}source\PYZhy{}databases}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gerp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
            \PY{n}{ref\PYZus{}genome}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hg19}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{result}
\end{Verbatim}


    \subsubsection{various test snippets}\label{various-test-snippets}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{missence\PYZus{}variants} \PY{o}{=} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}
            \PY{n}{maf\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Consequence}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{missense\PYZus{}variant}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}
        \PY{n}{var\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{k}{for} \PY{n}{entry} \PY{o+ow}{in} \PY{n}{maf\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{missence\PYZus{}variants}\PY{p}{]}\PY{p}{[}
            \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hugo\PYZus{}Symbol}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HGVSc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} concatenate as HUGO:HGVSc}
            \PY{n}{var\PYZus{}def} \PY{o}{=} \PY{n}{entry}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{entry}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
            \PY{n}{var\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{var\PYZus{}def}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} create batches of at most n variants}
        \PY{n}{n} \PY{o}{=} \PY{l+m+mi}{10}
        \PY{n}{q\PYZus{}chunks} \PY{o}{=} \PY{p}{[}\PY{n}{var\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{:}\PY{n}{i}\PY{o}{+}\PY{n}{n}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}
            \PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{var\PYZus{}list}\PY{p}{)}\PY{p}{,} \PY{n}{n}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


    \textbf{TODO: above, n is set to 10 for testing, for final release, set
to 10000 (ten thousand)}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{result} \PY{o}{=} \PY{n}{varsome\PYZus{}api}\PY{o}{.}\PY{n}{batch\PYZus{}lookup}\PY{p}{(}\PY{n}{q\PYZus{}chunks}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
                            \PY{n}{params}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{add\PYZhy{}source\PYZhy{}databases}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gerp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
                            \PY{n}{ref\PYZus{}genome}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hg19}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{interesting} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{chromosome}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{p}{[}\PY{n}{result}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{n}{x}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{interesting}\PY{p}{]}
\end{Verbatim}



    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
